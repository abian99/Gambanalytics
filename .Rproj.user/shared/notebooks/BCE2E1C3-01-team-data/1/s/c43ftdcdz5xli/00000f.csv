"0","library(nflfastR)"
"0","library(dplyr, warn.conflicts = FALSE)"
"0","library(tidyverse)"
"2","Registered S3 methods overwritten by 'dbplyr':
  method         from
  print.tbl_lazy     
  print.tbl_sql      
"
"2","â”€â”€ [1mAttaching packages[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.3.2 â”€â”€"
"2","[32mâœ”[39m [34mggplot2[39m 3.4.0     [32mâœ”[39m [34mpurrr  [39m 0.3.4
[32mâœ”[39m [34mtibble [39m 3.1.7     [32mâœ”[39m [34mstringr[39m 1.4.0
[32mâœ”[39m [34mtidyr  [39m 1.2.0     [32mâœ”[39m [34mforcats[39m 0.5.1
[32mâœ”[39m [34mreadr  [39m 2.1.2     "
"2","Warning: package â€˜ggplot2â€™ was built under R version 4.2.2"
"2","â”€â”€ [1mConflicts[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
[31mâœ–[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
[31mâœ–[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()"
"0","library(nflplotR)"
"2","Warning: package â€˜nflplotRâ€™ was built under R version 4.2.2"
"0","source(""buildFunctions.R"")"
"0","current_season = 2022"
"0","knitr::opts_chunk$set(echo = TRUE)"
"0","nflreadr::.clear_cache()"
"2","nflreadr function cache cleared!
"
"0","options(dplyr.summarise.inform = FALSE)"
"0","current_season_schedule <- fast_scraper_schedules(current_season)"
"2","Note: nflreadr caches (i.e., stores a saved version) data by default.
If you expect different output try one of the following:
[34mâ„¹[39m Restart your R Session or
[34mâ„¹[39m Run `nflreadr::.clear_cache()`.
To disable this warning, run `options(nflreadr.verbose = FALSE)` or add it to your .Rprofile"
"0","offense_pbp <- load_pbp(current_season) %>%"
"0","  filter(season_type == ""REG"") %>%"
"0","  filter(!is.na(posteam) & (rush == 1 | pass == 1))"
"0",""
"0","scores <-"
"0","  offense_pbp[c("
"0","    'game_id',"
"0","    'week',"
"0","    'home_team',"
"0","    'away_team',"
"0","    'season_type',"
"0","    'home_score',"
"0","    'away_score'"
"0","  )] %>%"
"0","  unique()"
"0",""
"0","home_df <-"
"0","  scores[c('week', 'home_team', 'away_team', 'home_score', 'away_score')] %>%"
"0","  rename(team = home_team) %>%"
"0","  group_by(team) %>%"
"0","  mutate("
"0","    oppositionTeam = away_team,"
"0","    PointsFor = mean(home_score),"
"0","    PointsAgainst = mean(away_score),"
"0","    win = if_else(home_score > away_score, 1, 0),"
"0","    pythWin = (PointsFor^13.91)/((PointsFor^13.91)+(PointsAgainst^13.91))"
"0","  ) %>%"
"0","  summarise(week,"
"0","            team,"
"0","            oppositionTeam,"
"0","            PointsFor,"
"0","            PointsAgainst,"
"0","            win,"
"0","            pythWin"
"0","            ) %>%"
"0","  unique()"
"0",""
"0","away_df <-"
"0","  scores[c('week', 'away_team', 'home_team', 'home_score', 'away_score')] %>%"
"0","  rename(team = away_team) %>%"
"0","  group_by(team) %>%"
"0","  mutate("
"0","    oppositionTeam = home_team,"
"0","    PointsFor = away_score,"
"0","    PointsAgainst = home_score,"
"0","    win = if_else(away_score > home_score, 1, 0),"
"0","    pythWin = (PointsFor^13.91)/((PointsFor^13.91)+(PointsAgainst^13.91))"
"0","  ) %>%"
"0","  summarize(week,"
"0","            team,"
"0","            oppositionTeam,"
"0","            PointsFor,"
"0","            PointsAgainst,"
"0","            win,"
"0","            pythWin"
"0","            ) %>%"
"0","  unique()"
"0",""
"0","schedule_df <- rbind(x = away_df, y = home_df)"
"0","avg_points = mean(schedule_df$PointsFor)"
"0",""
"0","team_df <- schedule_df %>%"
"0","  group_by(team) %>%"
"0","  mutate("
"0","    oRatio = mean(PointsFor / avg_points),"
"0","    dRatio = mean(PointsAgainst / avg_points),"
"0","    pointsFor = mean(PointsFor),"
"0","    pointsAgainst = mean(PointsAgainst),"
"0","    netPF = mean(PointsFor / dRatio),"
"0","    netPA = mean(PointsAgainst / oRatio),"
"0","    wins = sum(win),"
"0","    losses = sum(win == 0),"
"0","    winPct = wins / (wins + losses),"
"0","    pythWin = ((pointsFor^2.37)/((pointsFor^2.37)+(pointsAgainst^2.37)))*17"
"0","  ) %>%"
"0","  summarize(team,"
"0","            pointsFor,"
"0","            pointsAgainst,"
"0","            netPF,"
"0","            netPA,"
"0","            wins,"
"0","            pythWin,"
"0","            losses,"
"0","            winPct,"
"0","            oRatio,"
"0","            dRatio) %>%"
"0","  unique()"
